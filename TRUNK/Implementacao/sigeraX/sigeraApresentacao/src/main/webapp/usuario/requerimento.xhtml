<?xml version='1.0' encoding='UTF-8' ?>

<ui:composition template="template/template_principal.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:param name="funcao" value="consultar" />
    <ui:param name="nomeImagem" value="requerimento.png" />
    <ui:param name="paginaAtual" value="Detalhes de Requerimento" />

    <ui:define name="conteudo">

        <div class="row detalhe-requerimento">
            <div class="span12">  
                <h:form id="form">    
                    <p:messages closable="true"/>                    

                    <h:panelGroup rendered="#{detalheRequerimentoBean.requerimento != null}">     

                        <!-- Parecer intermediário de assinatura de contratos-->
                        <h:panelGroup id="panel-parecer-assinatura" rendered="#{detalheRequerimentoBean.usuarioPodeConferirDocumentos()}">

                            <div id="mostrar-parecer-assinatura">
                                <div class="form-actions">
                                    <p:commandLink id="botao-parecer-assinatura" styleClass="btn btn-success botao-com-margem-direita"
                                                   onclick="mostreControlesConferir();">
                                        <h:outputText value="Confirmar entrega e conferência de documentos" />
                                    </p:commandLink> 
                                </div>                          
                            </div>   

                            <div id="controles-parecer-assinatura" class="escondido">
                                <div class="div-doc-conf">
                                    <h:outputLabel for="doc-conferidos" styleClass="doc-conf" value="Documentos foram conferidos?" />    
                                    <p:selectBooleanButton id="doc-conferidos" value="#{detalheRequerimentoBean.documentosConferidos}" onLabel="Sim" offLabel="Não" onIcon="ui-icon-check" offIcon="ui-icon-close">
                                        <f:ajax event="change" render="botao-confirmar-parecer-assinatura" />
                                    </p:selectBooleanButton>
                                    <hr  style="margin: 8px !important;"/>
                                    <h:outputLabel styleClass="doc-conf" value="Encaminhar requerimento para:" />  
                                    <br/>

                                    <h:selectBooleanCheckbox id="ce"  styleClass="chk-parecer"  value="#{detalheRequerimentoBean.coordenadorEstagio}">
                                        <f:ajax event="change" render="botao-confirmar-parecer-assinatura" />
                                    </h:selectBooleanCheckbox>
                                    <h:outputLabel styleClass="doc-conf-atores" for="ce" value="Coordenador de estágio" />

                                    <h:selectBooleanCheckbox id="diretor" styleClass="chk-parecer" value="#{detalheRequerimentoBean.diretor}">
                                        <f:ajax event="change" render="botao-confirmar-parecer-assinatura" />
                                    </h:selectBooleanCheckbox>
                                    <h:outputLabel styleClass="doc-conf-atores" for="diretor" value="Diretor" />
                                </div>

                                <h:outputLabel for="justificativa-parecer-assinatura" value="Justificativa, comentários:" />
                                <h:inputTextarea  id="justificativa-parecer-assinatura" class="area-justificativa"  value="#{detalheRequerimentoBean.justificativaConferencia}" />                            

                                <div class="form-actions">
                                    <p:commandButton id="botao-confirmar-parecer-assinatura"
                                                     disabled="#{!detalheRequerimentoBean.validarConferencia()}"                                                      
                                                     styleClass="btn btn-primary botao-com-margem-direita" 
                                                     value="Confirmar conferência de documentos" 
                                                     action="#{detalheRequerimentoBean.confirmarConferencia()}" />                                                                        

                                    <p:commandLink id="botao-cancelar-parecer-assinatura" styleClass="btn" action="#{detalheRequerimentoBean.cancelarConferencia()}" update="doc-conferidos justificativa-parecer-assinatura ce diretor botao-confirmar-parecer-assinatura" 
                                                   onclick="escondaControlesConferir();">
                                        <h:outputText value="Cancelar conferência" />
                                    </p:commandLink>
                                </div>

                                <div class="spacer20"></div>
                            </div>

                        </h:panelGroup>

                        <!-- Dar parecer-->                        
                        <h:panelGroup id="panel-parecer" rendered="#{detalheRequerimentoBean.usuarioPodeDarParecer()}">                                                                
                            <div id="mostrar-parecer">
                                <div class="form-actions">                                
                                    <p:commandLink id="botao-parecer" styleClass="btn btn-success botao-com-margem-direita"
                                                   onclick="mostreControlesDeferimento();">
                                        <h:outputText value="Dar parecer ao requerimento" />
                                    </p:commandLink> 

                                </div>                          
                            </div>                               
                            <div id="controles-parecer" class="escondido">
                                <div class="form-actions form-actions-deferimento">
                                    <h:selectOneRadio id="botoes-selecao" styleClass="radio-deferimento" value="#{detalheRequerimentoBean.statusParecer}">
                                        <f:selectItems value="#{detalheRequerimentoBean.listaStatus}"
                                                       var="s"
                                                       itemLabel="#{s.nome}"
                                                       itemValue="#{s.codigo}"/>
                                        <f:ajax event="change" render="botao-confirmar-parecer" />
                                    </h:selectOneRadio>
                                </div>

                                <h:outputLabel for="justificativaParecer" value="Justificativa, comentários:" />
                                <h:inputTextarea  id="justificativaParecer" class="area-justificativa"  value="#{detalheRequerimentoBean.justificativaDeferimento}" />                            

                                <div class="form-actions">
                                    <p:commandButton id="botao-confirmar-parecer"
                                                     disabled="#{detalheRequerimentoBean.statusParecer == 0}" 
                                                     onclick="exibirConfirmacao('#{detalheRequerimentoBean.mensagemConfirmacao}', 'form:botao-teste')"                                                     
                                                     styleClass="btn btn-primary botao-com-margem-direita" 
                                                     value="Confirmar parecer" />                                    
                                    <p:commandLink styleClass="botao-escondido" id="botao-teste" action="#{detalheRequerimentoBean.confirmarParecer}" update="form" />

                                    <p:commandLink id="botao-cancelar-parecer" styleClass="btn" action="#{detalheRequerimentoBean.cancelarParecer}" update="botoes-selecao justificativaParecer botao-confirmar-parecer" 
                                                   onclick="escondaControlesDeferimento();">
                                        <h:outputText value="Cancelar parecer" />
                                    </p:commandLink>
                                </div>

                                <div class="spacer20"></div>
                            </div>

                        </h:panelGroup> 

                        <!-- Dar parecer de acréscimo/cancelamento de disciplina -->
                        <h:panelGroup id="panel-parecer-acerto" rendered="#{detalheRequerimentoBean.usuarioPodeDarParecerAcertoMatricula()}">

                            <div id="mostrar-parecer-acerto">
                                <div class="form-actions">
                                    <p:commandLink id="botao-parecer-acerto" styleClass="btn btn-success botao-com-margem-direita"
                                                   onclick="mostreControlesDeferimentoAcerto();">
                                        <h:outputText value="Dar parecer ao requerimento" />
                                    </p:commandLink> 
                                </div>                          
                            </div>   

                            <div id="controles-parecer-acerto" class="escondido">

                                <p:dataTable styleClass="largura-minima-tabela"
                                             id="datatable-acerto" var="turmaAcerto" value="#{detalheRequerimentoBean.turmasComStatus}"                                             
                                             emptyMessage="#{msgs['MT.401']}">

                                    <p:column width="46%">
                                        <f:facet name="header">  
                                            <h:outputText value="Disciplina" />
                                        </f:facet> 
                                        <h:outputText value="#{turmaAcerto.turma.disciplina.nome}" />
                                    </p:column>       

                                    <p:column width="20%">
                                        <f:facet name="header">  
                                            <h:outputText value="Curso" />
                                        </f:facet> 
                                        <h:outputText value="#{turmaAcerto.turma.disciplina.curso.nome}" />
                                    </p:column>       

                                    <p:column width="20%">
                                        <f:facet name="header">  
                                            <h:outputText value="Professor" />
                                        </f:facet> 
                                        <h:outputText value="#{turmaAcerto.turma.professor.nome}" />
                                    </p:column>       

                                    <p:column width="10%">
                                        <f:facet name="header">  
                                            <h:outputText value="Turma" />
                                        </f:facet> 
                                        <h:outputText value="#{turmaAcerto.turma.nome}" />
                                    </p:column> 

                                    <p:column width="10%">
                                        <f:facet name="header">  
                                            <h:outputText value="Parecer" />
                                        </f:facet> 
                                        <p:selectOneRadio id="botoes-selecao-acerto" value="#{turmaAcerto.status}">
                                            <f:selectItems value="#{detalheRequerimentoBean.listaStatus}"
                                                           var="s"
                                                           itemLabel="#{s.nome}"
                                                           itemValue="#{s.codigo}"/>
                                            <f:ajax event="change" render=":form:botao-confirmar-parecer-acerto" />
                                        </p:selectOneRadio>
                                    </p:column>
                                </p:dataTable>

                                <div class="spacer15"></div>

                                <h:outputLabel for="justificativa-parecer-acerto" value="Justificativa, comentários:" />
                                <h:inputTextarea  id="justificativa-parecer-acerto" class="area-justificativa"  value="#{detalheRequerimentoBean.justificativaParecerAcerto}" />                            

                                <div class="form-actions">
                                    <p:commandButton id="botao-confirmar-parecer-acerto"
                                                     disabled="#{!detalheRequerimentoBean.validarStatusParecerAcerto()}" 
                                                     onclick="exibirConfirmacao('#{detalheRequerimentoBean.mensagemConfirmacao}', 'form:botao-teste-acerto')"                                                     
                                                     styleClass="btn btn-primary botao-com-margem-direita" 
                                                     value="Confirmar parecer" />                                    
                                    <p:commandLink styleClass="botao-escondido" id="botao-teste-acerto" action="#{detalheRequerimentoBean.confirmarParecerAcerto()}" update="form" />

                                    <p:commandLink id="botao-cancelar-parecer-acerto" styleClass="btn" action="#{detalheRequerimentoBean.cancelarParecerAcerto()}" update="datatable-acerto justificativa-parecer-acerto botao-confirmar-parecer-acerto" 
                                                   onclick="escondaControlesDeferimentoAcerto();">
                                        <h:outputText value="Cancelar parecer" />
                                    </p:commandLink>
                                </div>

                                <div class="spacer20"></div>
                            </div>

                        </h:panelGroup>

                        <!-- Dados básicos do requerimento-->
                        <table class="table table-bordered">                        
                            <tr>
                                <th class="lead tipo-requerimento">
                                    <h:outputText value="#{detalheRequerimentoBean.requerimento.descricaoTipo}"/>
                                </th>
                            </tr>

                            <tr>
                                <td>
                                    <h:outputText styleClass="negrito" value="Requisição &#35;#{detalheRequerimentoBean.requerimento.id}" />
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <h:outputText styleClass="negrito" value="Data de abertura: "/>
                                    <h:outputText value="#{detalheRequerimentoBean.requerimento.dataAbertura}">
                                        <f:convertDateTime  locale="BR" pattern="dd/MM/yyyy HH:mm" timeZone="America/Sao_Paulo"/>                     
                                    </h:outputText>                           
                                </td>                            
                            </tr>

                            <h:panelGroup rendered="#{detalheRequerimentoBean.requerimento.dataFechamento != null}">
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Data de fechamento: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.dataFechamento}">
                                            <f:convertDateTime  locale="BR" pattern="dd/MM/yyyy HH:mm" timeZone="America/Sao_Paulo"/>                     
                                        </h:outputText>                           
                                    </td>                            
                                </tr>
                            </h:panelGroup>

                            <tr class="#{detalheRequerimentoBean.cssStatus()}">
                                <td>
                                    <h:outputText styleClass="negrito" value="Status: "/>
                                    <h:outputText value="#{detalheRequerimentoBean.requerimento.descricaoStatus}"/>
                                </td>                            
                            </tr>

                            <h:panelGroup rendered="#{detalheRequerimentoBean.requerimentoEhPlano()}" >

                                <tr style="color:#004b82; background-color:#f0ffff ">
                                    <td>
                                        <h:outputText styleClass="negrito " value="Turma: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.plano.turma.disciplina.nome}"/>
                                        <h:outputText value=" [ #{detalheRequerimentoBean.requerimento.plano.turma.nome} ] "/>
                                        <h:outputText styleClass="negrito" value="Curso: "/> 
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.plano.turma.disciplina.curso.nome} "/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Requerente: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.usuarioLdap.cn}"/>
                                    </td>                            
                                </tr>                                
                            </h:panelGroup>


                            <h:panelGroup rendered="#{!detalheRequerimentoBean.requerimentoEhPlano()}" >
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Nome do estudante: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.usuarioLdap.cn}"/>
                                    </td>                            
                                </tr>

                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Matrícula: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.usuarioLdap.matricula}"/>
                                    </td>
                                </tr>

                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Curso: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.curso.nome}"/>
                                    </td>
                                </tr>
                            </h:panelGroup>
                            <h:panelGroup rendered="#{detalheRequerimentoBean.podeVisualizarTelefone()}">
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="E-mail: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.usuarioLdap.email}"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Telefones: "/>                                        
                                        <h:panelGroup rendered="#{!empty detalheRequerimentoBean.requerimento.usuario.telefoneCelular}">
                                            <h:graphicImage title="Celular" styleClass="icones-telefones" url="/resources/img/mobile.png" />
                                            <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.telefoneCelular} " />                                        
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{!empty detalheRequerimentoBean.requerimento.usuario.telefoneResidencial}">
                                            <h:graphicImage title="Residencial" styleClass="icones-telefones" url="/resources/img/home_small.png" />
                                            <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.telefoneResidencial} " />                                        
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{!empty detalheRequerimentoBean.requerimento.usuario.telefoneComercial}">
                                            <h:graphicImage title="Comercial" styleClass="icones-telefones" url="/resources/img/trabalho.png" />
                                            <h:outputText value="#{detalheRequerimentoBean.requerimento.usuario.telefoneComercial} "/>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{detalheRequerimentoBean.requerimento.usuario.id == loginBean.usuario.id and empty detalheRequerimentoBean.requerimento.usuario.telefoneCelular and empty detalheRequerimentoBean.requerimento.usuario.telefoneResidencial and empty detalheRequerimentoBean.requerimento.usuario.telefoneComercial}">
                                            <h:commandLink action="editar_perfil">
                                                <h:outputText value="#{msgs['MT.406']}"/>
                                            </h:commandLink>
                                        </h:panelGroup>
                                    </td>
                                </tr>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{detalheRequerimentoBean.requerimento.justificativa != null}">
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Justificativa/Observações: "/>
                                        <h:outputText value="#{detalheRequerimentoBean.requerimento.justificativa}"/>
                                    </td>
                                </tr>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{detalheRequerimentoBean.dataProva != null}">
                                <tr>
                                    <td>
                                        <h:outputText styleClass="negrito" value="Data da prova: "/> 
                                        <h:outputText value="#{detalheRequerimentoBean.dataProva}">
                                            <f:convertDateTime  locale="BR" pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>                      
                                        </h:outputText>                                        
                                    </td>
                                </tr>
                            </h:panelGroup>                            

                            <h:panelGroup rendered="#{detalheRequerimentoBean.turma != null}">
                                <tr>
                                    <td>
                                        <h:outputText value="#{detalheRequerimentoBean.turma}"/>
                                    </td>
                                </tr>
                            </h:panelGroup>
                        </table>                       

                        <!-- Lista de pareceres-->
                        <h:panelGroup rendered="#{detalheRequerimentoBean.podeVisualizarPareceres()}">            
                            <table class="table table-bordered">                        
                                <tr>
                                    <th>Andamentos do requerimento</th>
                                </tr>
                                <tr>
                                    <th>Usuário</th>
                                    <th>Data</th>
                                    <th>Status</th>                                    
                                </tr>

                                <ui:repeat value="#{detalheRequerimentoBean.obtenhaPareceres()}" var="parecer">
                                    <tr class="cabecalho-parecer">
                                        <td>                                           
                                            <h:outputText value="#{parecer.usuario.nome}" />
                                        </td>                                        
                                        <td>          
                                            <h:outputText value="#{parecer.dataParecer}">
                                                <f:convertDateTime  locale="BR" pattern="dd/MM/yyyy HH:mm" timeZone="America/Sao_Paulo"/>                     
                                            </h:outputText>                                             
                                        </td>                                        
                                        <td>                                           
                                            <h:outputText value="#{parecer.descricaoStatus}" />
                                        </td>                                        
                                    </tr>
                                    <h:panelGroup rendered="#{!empty parecer.conteudo}">
                                        <tr>
                                            <td colspan="3">                                           
                                                <pre class="pre-modificado"> <h:outputText value="#{parecer.conteudo}" /> </pre>
                                            </td>                                                                                
                                        </tr>
                                    </h:panelGroup>
                                </ui:repeat>
                            </table> 
                        </h:panelGroup>

                        <!-- Disciplinas-->
                        <h:panelGroup rendered="#{detalheRequerimentoBean.requerimento.disciplinas != null}">
                            <table class="table table-bordered">                        
                                <tr>
                                    <th>Ementas Solicitadas</th>
                                </tr>

                                <tr>
                                    <th>Disciplina</th>
                                    <th>Curso</th>
                                    <th>Ação</th>
                                </tr>

                                <ui:repeat value="#{detalheRequerimentoBean.requerimento.disciplinas}" var="disciplina">
                                    <tr>
                                        <td>#{disciplina.nome}</td>
                                        <td>#{disciplina.curso.nome}</td>

                                        <h:panelGroup id="panel-visualizar-ementa" rendered="#{!loginBean.usuario.perfilAtual.perfil.permiteImprimirEmenta()}"> 
                                            <td>
                                                <h:link target="_blank" styleClass="btn centralizado" value="Visualizar ementa" outcome="#{detalheRequerimentoBean.visualizarEmenta()}">
                                                    <f:param name="id" value="#{disciplina.id}" />                                                
                                                </h:link>                                            
                                            </td>
                                        </h:panelGroup>

                                        <h:panelGroup id="panel-imprimir-ementa" rendered="#{loginBean.usuario.perfilAtual.perfil.permiteImprimirEmenta()}"> 
                                            <td>
                                                <h:commandLink target="_blank" styleClass="btn centralizado"  value="Imprimir ementa " 
                                                               action="#{detalheRequerimentoBean.imprimirEmenta(disciplina.id)}">
                                                    <h:graphicImage library="img" name="printer.png" height="20px" width="20px"/>                                                     
                                                    <f:param name="id" value="#{disciplina.id}" />                                                                                    
                                                </h:commandLink>                                            
                                            </td>
                                        </h:panelGroup>

                                    </tr>
                                </ui:repeat>
                            </table>                             
                        </h:panelGroup>   

                        <!-- Turmas-->
                        <h:panelGroup rendered="#{detalheRequerimentoBean.turmasComStatus.size() > 0}">
                            <table class="table table-bordered">                        
                                <tr>
                                    <th>Turmas Solicitadas</th>
                                </tr>

                                <tr>
                                    <th>Disciplina</th>
                                    <th>Professor</th>
                                    <th>Turma</th>

                                    <h:panelGroup rendered="#{detalheRequerimentoBean.podeVisualizarPareceres()}">
                                        <th>Status</th>
                                    </h:panelGroup>  

                                    <h:panelGroup rendered="#{detalheRequerimentoBean.usuarioPodeDarParecerAcertoMatricula()}">
                                        <th>Consultar</th>
                                    </h:panelGroup>  


                                </tr>

                                <ui:repeat value="#{detalheRequerimentoBean.turmasComStatus}" var="infoTurma">
                                    <tr>
                                        <td>#{infoTurma.turma.disciplina.nome}</td>
                                        <td>#{infoTurma.turma.professor.nome}</td>
                                        <td>#{infoTurma.turma.nome}</td>
                                        <h:panelGroup rendered="#{detalheRequerimentoBean.podeVisualizarPareceres()}">
                                            <td>#{infoTurma.descricaoStatus}</td>
                                        </h:panelGroup>

                                        <h:panelGroup rendered="#{detalheRequerimentoBean.usuarioPodeDarParecerAcertoMatricula()}">
                                            <td >
                                                <p:commandButton id="extrato-turma" styleClass="btn centralizado link_turmas" title="Extrato pedidos abertos dessa turma." value="Mais informações" action="#{detalheRequerimentoBean.visualizarExtrato(infoTurma.turma.id)}">
                                                    <f:param name="id" value="#{infoTurma.turma.id}" />                                                
                                                    <p:overlayPanel for="extrato-turma" dynamic="true" hideEffect="fade" >
                                                        <h:outputLabel value="#{inforTurma.turma.nome}"/>
                                                        <h:outputLabel value=" Pedidos de Acréscimo em aberto.......: " style="display: inline"/>
                                                        <h:outputLabel value="#{detalheRequerimentoBean.qtdePedidosAcrescimo}" style="font-weight: bold; color: #0044cc ; display:inline"/>
                                                        <br/>
                                                        <h:outputLabel value=" Pedidos de Cancelamento em aberto.: " style="display:inline"/>
                                                        <h:outputLabel value="#{detalheRequerimentoBean.qtdePedidosCancelamento}" style="font-weight: bold; color: #e9322d; display:inline"/>                                                                                                                
                                                    </p:overlayPanel>
                                                </p:commandButton>
                                            </td>
                                        </h:panelGroup>  

                                    </tr>
                                </ui:repeat>
                            </table> 
                        </h:panelGroup> 

                        <!-- Anexos-->
                        <h:panelGroup rendered="#{detalheRequerimentoBean.podeVisualizarAnexos()}">            
                            <table class="table table-bordered">                        
                                <tr>
                                    <th>Arquivos anexos</th>
                                </tr>

                                <ui:repeat value="#{detalheRequerimentoBean.requerimento.anexos}" var="anexo">
                                    <tr>
                                        <td>
                                            <p:commandLink id="linkArquivo" ajax="false">
                                                <h:outputText value="#{anexo.nome}" />
                                                <p:fileDownload value="#{segundaChamadaBean.download(anexo)}" />                                                  
                                            </p:commandLink>
                                        </td>                                        
                                    </tr>
                                </ui:repeat>
                            </table> 
                        </h:panelGroup>   

                        <!-- Botões de controle (cancelar, voltar à página principal, etc.)-->
                        <div class="form-actions">                            
                            <h:panelGroup rendered="#{detalheRequerimentoBean.requerimentoEhPlano()}">
                                <h:commandLink id="btnDetalhe2" 
                                               styleClass="btn btn-success botao-com-margem-direita" 
                                               value="Visualizar Plano de Ensino" 
                                               action="#{detalheRequerimentoBean.editarPlano()}" > 
                                    <f:setPropertyActionListener target="#{detalheRequerimentoBean.requerimento.plano}" 
                                                                 value="#{detalheRequerimentoBean.requerimento.plano}" />
                                </h:commandLink>
                            </h:panelGroup>            

                            <h:commandButton styleClass="btn btn-primary botao-com-margem-direita" value="Voltar à lista de requerimentos" action="#{detalheRequerimentoBean.voltarLista}" /> 

                            <h:panelGroup rendered="#{detalheRequerimentoBean.usuarioPodeCancelar()}">
                                <input  type="button" class="btn btn-danger botao-com-margem-direita" value="Cancelar o requerimento"  
                                        onclick="exibirConfirmacao('#{msgs['MT.511']}', 'form:botao-escondido')"/>
                                <p:commandLink  styleClass="botao-escondido" id="botao-escondido" action="#{detalheRequerimentoBean.cancelar}" update="form"/>
                            </h:panelGroup>




                            <h:commandButton styleClass="btn" value="Voltar à página inicial" action="#{detalheRequerimentoBean.voltar}" /> 
                        </div>  

                    </h:panelGroup>

                    <h:panelGroup rendered="#{detalheRequerimentoBean.requerimento == null}">
                        <p class="lead">Requerimento não encontrado.</p>
                    </h:panelGroup>
                </h:form>

            </div>
        </div>

        <h:outputScript library="js" name="deferimento.js" />
    </ui:define>    
</ui:composition>